<EditDataFormTemplateSpec 
    xmlns:c="bb_appfx_commontypes"
    ID="32654560-F638-4E61-8AAA-382C4E812880"
    Name="Child Project Required Docs Edit Form"
    Description="Used for editing the Required Documents information for a Child Project Extension"
    Author="Cary Mayeda"
    RecordType="Child Project Extension"
    DataFormInstanceID="8FD24692-77FB-4074-AD45-4C9AC6CBF190"
    c:SecurityUIFolder="Sponsorship\Opportunity\Child Project"
    OwnerIDMapperID="00000000-0000-0000-0000-000000000000"
    xmlns="bb_appfx_editdataformtemplate"
    >

<!-- 
Remarks:    ID is a foreign key to the related CONSTITUENT.ID

History:
Date            Modified By     Comments
27-Mar-2012     CMayeda         Initial Version
02-May-2012		CMayeda			Removed CONSTITUENTID column
-->

	<SPDataForm>		
		<LoadImplementation SPName="USR_USP_DATAFORMTEMPLATE_EDITLOAD_CHILDPROJECT_REQUIREDDOCS">
            <c:CreateProcedureSQL>
<![CDATA[
create procedure dbo.USR_USP_DATAFORMTEMPLATE_EDITLOAD_CHILDPROJECT_REQUIREDDOCS
(
    @ID uniqueidentifier,
    @DATALOADED bit = 0 output,
    @TSLONG bigint = 0 output,
    @DOCSTATUSCOMMUNITYDESCCODEID uniqueidentifier = null output,
    @DOCSTATUSCOMMUNITYPHOTOCODEID uniqueidentifier = null output,
    @DOCSTATUSPROJECTFORMAPPROVALFORMCODEID uniqueidentifier = null output,
    @DOCSTATUSPROJECTFORMCAPITALPROPOSALCODEID uniqueidentifier = null output,
    @DOCSTATUSPROJECTFORMCOMMUNITYFORMCODEID uniqueidentifier = null output,
    @DOCSTATUSPROJECTFORMINTENTTOPARTNERCODEID uniqueidentifier = null output,
    @DOCSTATUSPROJECTFORMPARTNERAGREEMENTCODEID uniqueidentifier = null output,
    @DOCSTATUSPROJECTFORMPARTNERINFOCODEID uniqueidentifier = null output,
    @DOCSTATUSPROJECTFORMPROGRAMCODEID uniqueidentifier = null output,
    @DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALFULLCODEID uniqueidentifier = null output,
    @DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALSUMMARYCODEID uniqueidentifier = null output
)
as

	set nocount on;

	-- be sure to set these, in case the select returns no rows
	set @DATALOADED = 0
	set @TSLONG = 0

	-- populate the output parameters, which correspond to fields on the form.  Note that
	-- we set @DATALOADED = 1 to indicate that the load was successful.  Otherwise, the system
	-- will display a "no data loaded" message.  Also note that we fetch the TSLONG so that concurrency
	-- can be considered.
	select
		@DATALOADED = 1,
		@TSLONG = TSLONG,
        @DOCSTATUSCOMMUNITYDESCCODEID = DOCSTATUSCOMMUNITYDESCCODEID, 
        @DOCSTATUSCOMMUNITYPHOTOCODEID = DOCSTATUSCOMMUNITYPHOTOCODEID, 
        @DOCSTATUSPROJECTFORMAPPROVALFORMCODEID = DOCSTATUSPROJECTFORMAPPROVALFORMCODEID, 
        @DOCSTATUSPROJECTFORMCAPITALPROPOSALCODEID = DOCSTATUSPROJECTFORMCAPITALPROPOSALCODEID, 
        @DOCSTATUSPROJECTFORMCOMMUNITYFORMCODEID = DOCSTATUSPROJECTFORMCOMMUNITYFORMCODEID, 
        @DOCSTATUSPROJECTFORMINTENTTOPARTNERCODEID = DOCSTATUSPROJECTFORMINTENTTOPARTNERCODEID, 
        @DOCSTATUSPROJECTFORMPARTNERAGREEMENTCODEID = DOCSTATUSPROJECTFORMPARTNERAGREEMENTCODEID, 
        @DOCSTATUSPROJECTFORMPARTNERINFOCODEID = DOCSTATUSPROJECTFORMPARTNERINFOCODEID, 
        @DOCSTATUSPROJECTFORMPROGRAMCODEID = DOCSTATUSPROJECTFORMPROGRAMCODEID, 
        @DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALFULLCODEID = DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALFULLCODEID, 
        @DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALSUMMARYCODEID = DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALSUMMARYCODEID
	from dbo.USR_CHILDPROJECTEXTENSION
	where ID = @ID

	return 0;
]]>
</c:CreateProcedureSQL>
        </LoadImplementation>
		<SaveImplementation SPName="USR_USP_DATAFORMTEMPLATE_EDIT_CHILDPROJECT_REQUIREDDOCS">
            <c:CreateProcedureSQL>
<![CDATA[
create procedure dbo.USR_USP_DATAFORMTEMPLATE_EDIT_CHILDPROJECT_REQUIREDDOCS
(
	@ID uniqueidentifier,
	@CHANGEAGENTID uniqueidentifier = null,
    @DOCSTATUSCOMMUNITYDESCCODEID uniqueidentifier,
    @DOCSTATUSCOMMUNITYPHOTOCODEID uniqueidentifier,
    @DOCSTATUSPROJECTFORMAPPROVALFORMCODEID uniqueidentifier,
    @DOCSTATUSPROJECTFORMCAPITALPROPOSALCODEID uniqueidentifier,
    @DOCSTATUSPROJECTFORMCOMMUNITYFORMCODEID uniqueidentifier,
    @DOCSTATUSPROJECTFORMINTENTTOPARTNERCODEID uniqueidentifier,
    @DOCSTATUSPROJECTFORMPARTNERAGREEMENTCODEID uniqueidentifier,
    @DOCSTATUSPROJECTFORMPARTNERINFOCODEID uniqueidentifier,
    @DOCSTATUSPROJECTFORMPROGRAMCODEID uniqueidentifier,
    @DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALFULLCODEID uniqueidentifier,
    @DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALSUMMARYCODEID uniqueidentifier
)
as

	set nocount on;

	if @CHANGEAGENTID is null  
		exec dbo.USP_CHANGEAGENT_GETORCREATECHANGEAGENT @CHANGEAGENTID output
						
	begin try
		-- handle updating the data
		update dbo.USR_CHILDPROJECTEXTENSION set
            DOCSTATUSCOMMUNITYDESCCODEID = @DOCSTATUSCOMMUNITYDESCCODEID,
            DOCSTATUSCOMMUNITYPHOTOCODEID = @DOCSTATUSCOMMUNITYPHOTOCODEID,
            DOCSTATUSPROJECTFORMAPPROVALFORMCODEID = @DOCSTATUSPROJECTFORMAPPROVALFORMCODEID,
            DOCSTATUSPROJECTFORMCAPITALPROPOSALCODEID = @DOCSTATUSPROJECTFORMCAPITALPROPOSALCODEID,
            DOCSTATUSPROJECTFORMCOMMUNITYFORMCODEID = @DOCSTATUSPROJECTFORMCOMMUNITYFORMCODEID,
            DOCSTATUSPROJECTFORMINTENTTOPARTNERCODEID = @DOCSTATUSPROJECTFORMINTENTTOPARTNERCODEID,
            DOCSTATUSPROJECTFORMPARTNERAGREEMENTCODEID = @DOCSTATUSPROJECTFORMPARTNERAGREEMENTCODEID,
            DOCSTATUSPROJECTFORMPARTNERINFOCODEID = @DOCSTATUSPROJECTFORMPARTNERINFOCODEID,
            DOCSTATUSPROJECTFORMPROGRAMCODEID = @DOCSTATUSPROJECTFORMPROGRAMCODEID,
            DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALFULLCODEID = @DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALFULLCODEID,
            DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALSUMMARYCODEID = @DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALSUMMARYCODEID,

			CHANGEDBYID = @CHANGEAGENTID,
			DATECHANGED = getdate()
		where ID = @ID
	end try
	begin catch
		exec dbo.USP_RAISE_ERROR
		return 1
	end catch

return 0;
]]>
</c:CreateProcedureSQL>
            <c:ExpectedDBExceptions>
                <c:Constraints>
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSCOMMUNITYDESCCODEID" Field="DOCSTATUSCOMMUNITYDESCCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSCOMMUNITYPHOTOCODEID" Field="DOCSTATUSCOMMUNITYPHOTOCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSPROJECTFORMAPPROVALFORMCODEID" Field="DOCSTATUSPROJECTFORMAPPROVALFORMCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSPROJECTFORMCAPITALPROPOSALCODEID" Field="DOCSTATUSPROJECTFORMCAPITALPROPOSALCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSPROJECTFORMCOMMUNITYFORMCODEID" Field="DOCSTATUSPROJECTFORMCOMMUNITYFORMCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSPROJECTFORMINTENTTOPARTNERCODEID" Field="DOCSTATUSPROJECTFORMINTENTTOPARTNERCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSPROJECTFORMPARTNERAGREEMENTCODEID" Field="DOCSTATUSPROJECTFORMPARTNERAGREEMENTCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSPROJECTFORMPARTNERINFOCODEID" Field="DOCSTATUSPROJECTFORMPARTNERINFOCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSPROJECTFORMPROGRAMCODEID" Field="DOCSTATUSPROJECTFORMPROGRAMCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALFULLCODEID" Field="DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALFULLCODEID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDPROJECTEXTENSION_DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALSUMMARYCODEID" Field="DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALSUMMARYCODEID" Type="ForeignKey" />
                </c:Constraints>
            </c:ExpectedDBExceptions>
        </SaveImplementation>
    </SPDataForm>
    <c:FormMetaData FixedDialog="true">		
        <c:FormFields>
            <c:FormField FieldID="ID" DataType="Guid" Hidden="true" Caption="ID" />
            <c:FormField FieldID="DOCSTATUSCOMMUNITYDESCCODEID" DataType="Guid" Caption="Community description">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTDOCUMENTATIONSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSCOMMUNITYPHOTOCODEID" DataType="Guid" Caption="Community photo">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTDOCUMENTATIONSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSPROJECTFORMAPPROVALFORMCODEID" DataType="Guid" Caption="Approval form">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTFORMSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSPROJECTFORMCAPITALPROPOSALCODEID" DataType="Guid" Caption="Capital proposal">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTFORMSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSPROJECTFORMCOMMUNITYFORMCODEID" DataType="Guid" Caption="Community form">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTFORMSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSPROJECTFORMINTENTTOPARTNERCODEID" DataType="Guid" Caption="Intent to partner">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTFORMSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSPROJECTFORMPARTNERAGREEMENTCODEID" DataType="Guid" Caption="Partner agreement">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTFORMSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSPROJECTFORMPARTNERINFOCODEID" DataType="Guid" Caption="Partner information">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTFORMSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSPROJECTFORMPROGRAMCODEID" DataType="Guid" Caption="Program">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTFORMSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALFULLCODEID" DataType="Guid" Caption="Sponsorship proposal - full">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTFORMSTATUSCODE" />
            </c:FormField>
            <c:FormField FieldID="DOCSTATUSPROJECTFORMSPONSORSHIPPROPOSALSUMMARYCODEID" DataType="Guid" Caption="Sponsorship proposal - summary">
                <c:CodeTable CodeTableName="USR_CHILDPROJECTFORMSTATUSCODE" />
            </c:FormField>
        </c:FormFields>
        <c:FormUIComponent />

		<!--c:WebUIComponent>
            <c:UIModel AssemblyName="CarySpecs.dll" ClassName="CarySpecs.ChildProjectRequiredDocsEditFormUIModel" />
            <c:WebUI>
                <c:ExternalResource Url="browser/htmlforms/custom/ChildProjectRequiredDocsEditForm.html" />
            </c:WebUI>
        </c:WebUIComponent-->
    </c:FormMetaData>
</EditDataFormTemplateSpec>